import{u as x,d as p,j as e}from"./main-amE6mPDm.js";import{u as h}from"./useQuery-DdeLzvk4.js";import{u as c}from"./useMutation-BBcAv7H8.js";import{a as i}from"./api-client-CoYXQ-f4.js";function g(){var l,r;const{token:t}=x(),n=p(),o=h({queryKey:["files"],queryFn:async()=>await i.listFiles(t||"",{page:1,limit:20}),enabled:!!t}),a=c({mutationFn:async s=>i.uploadFile(t||"",s),onSuccess:()=>n.invalidateQueries({queryKey:["files"]})}),u=c({mutationFn:async s=>i.deleteFile(t||"",s),onSuccess:()=>n.invalidateQueries({queryKey:["files"]})}),d=s=>{s.preventDefault();const m=new FormData(s.currentTarget);a.mutate(m),s.currentTarget.reset()};return e.jsxs("div",{className:"p-4 max-w-5xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Files"}),e.jsxs("form",{onSubmit:d,className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"file",name:"file",required:!0}),e.jsxs("select",{name:"bucket",className:"border p-1 rounded",children:[e.jsx("option",{value:"general",children:"general"}),e.jsx("option",{value:"avatars",children:"avatars"}),e.jsx("option",{value:"course-assets",children:"course-assets"})]}),e.jsxs("label",{className:"flex items-center gap-1 text-sm",children:[e.jsx("input",{type:"checkbox",name:"is_public",value:"true"})," Public"]}),e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded",disabled:a.isPending,children:a.isPending?"Uploading...":"Upload"})]}),e.jsx("ul",{className:"divide-y bg-white rounded border",children:(r=(l=o.data)==null?void 0:l.files)==null?void 0:r.map(s=>e.jsxs("li",{className:"p-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.filename||s.name}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.content_type," â€¢ ",Math.round((s.size||0)/1024)," KB"]})]}),e.jsx("button",{className:"text-red-600",onClick:()=>u.mutate(s.file_id||s.id),children:"Delete"})]},s.file_id||s.id))})]})}export{g as component};
