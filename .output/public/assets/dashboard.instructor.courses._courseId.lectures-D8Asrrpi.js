import{af as p,u as x,d as b,j as e}from"./main-amE6mPDm.js";import{u as g}from"./useQuery-DdeLzvk4.js";import{u as h}from"./useMutation-BBcAv7H8.js";import{a as u}from"./api-client-CoYXQ-f4.js";import{I as f}from"./InstructorGuard-2KiUKDdY.js";function w(){var n,d;const{courseId:s}=p.useParams(),{token:o}=x(),c=b(),i=g({queryKey:["lectures",s],queryFn:async()=>(await u.listLectures(s,{page:1,page_size:100})).data}),a=h({mutationFn:async t=>u.createLecture(o||"",t),onSuccess:()=>c.invalidateQueries({queryKey:["lectures",s]})}),l=t=>{t.preventDefault();const r=new FormData(t.currentTarget),m={course_id:s,title:String(r.get("title")||""),description:String(r.get("description")||""),order_number:Number(r.get("order_number")||"1"),duration_minutes:Number(r.get("duration_minutes")||"0"),is_free:String(r.get("is_free")||"")==="true",video_id:String(r.get("video_id")||"")};a.mutate(m),t.currentTarget.reset()};return e.jsx(f,{children:e.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Manage Lectures"}),e.jsxs("form",{className:"flex flex-col gap-2 mb-4",onSubmit:l,children:[e.jsx("input",{name:"title",placeholder:"Lecture title",className:"border p-2 rounded",required:!0}),e.jsx("textarea",{name:"description",placeholder:"Description",className:"border p-2 rounded"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{name:"order_number",type:"number",placeholder:"Order",className:"border p-2 rounded",defaultValue:(((n=i.data)==null?void 0:n.lectures)??[]).length+1}),e.jsx("input",{name:"duration_minutes",type:"number",placeholder:"Duration (min)",className:"border p-2 rounded"}),e.jsx("input",{name:"video_id",placeholder:"Video ID (optional)",className:"border p-2 rounded"})]}),e.jsxs("label",{className:"text-sm",children:[e.jsx("input",{type:"checkbox",name:"is_free",value:"true"})," Free preview"]}),e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded self-start",disabled:a.isPending,children:a.isPending?"Adding...":"Add Lecture"})]}),e.jsx("ul",{className:"divide-y bg-white border rounded",children:(((d=i.data)==null?void 0:d.lectures)??[]).map(t=>e.jsx("li",{className:"p-3 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[t.order_number,". ",t.title]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[t.duration_minutes," min • video: ",t.video_id||"—"]})]})},t.id))})]})})}export{w as component};
