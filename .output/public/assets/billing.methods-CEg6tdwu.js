import{u as g,d as b,j as e}from"./main-amE6mPDm.js";import{u as f}from"./useQuery-DdeLzvk4.js";import{u as d}from"./useMutation-BBcAv7H8.js";import{a as n}from"./api-client-CoYXQ-f4.js";function P(){var o;const{token:s}=g(),r=b(),l=f({queryKey:["billing","methods"],queryFn:async()=>(await n.listPaymentMethods(s||"")).payment_methods??[],enabled:!!s}),i=d({mutationFn:async t=>n.createPaymentMethod(s||"",t),onSuccess:()=>r.invalidateQueries({queryKey:["billing","methods"]})}),c=d({mutationFn:async t=>n.deletePaymentMethod(s||"",t),onSuccess:()=>r.invalidateQueries({queryKey:["billing","methods"]})}),u=d({mutationFn:async t=>n.setDefaultPaymentMethod(s||"",t),onSuccess:()=>r.invalidateQueries({queryKey:["billing","methods"]})}),m=t=>{t.preventDefault();const a=new FormData(t.currentTarget),p=String(a.get("provider")||"stripe"),x=String(a.get("token")||""),h=String(a.get("last4")||""),y=String(a.get("expiry")||"");i.mutate({provider:p,token:x,card_last_four:h,card_expiry:y}),t.currentTarget.reset()};return e.jsxs("div",{className:"p-4 max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Payment Methods"}),e.jsxs("form",{onSubmit:m,className:"flex flex-col gap-2 mb-4",children:[e.jsx("input",{name:"provider",placeholder:"Provider (e.g., stripe)",className:"border p-2 rounded",defaultValue:"stripe"}),e.jsx("input",{name:"token",placeholder:"Provider token",className:"border p-2 rounded",required:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{name:"last4",placeholder:"Card last 4",className:"border p-2 rounded"}),e.jsx("input",{name:"expiry",placeholder:"MM/YYYY",className:"border p-2 rounded"})]}),e.jsx("button",{className:"px-3 py-2 bg-blue-600 text-white rounded self-start",disabled:i.isPending,children:i.isPending?"Adding...":"Add Method"})]}),e.jsx("ul",{className:"divide-y bg-white border rounded",children:(o=l.data)==null?void 0:o.map(t=>e.jsxs("li",{className:"p-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[t.provider," ••••",t.card_last_four]}),e.jsx("p",{className:"text-xs text-gray-600",children:t.card_expiry})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"text-blue-600",onClick:()=>u.mutate(t.id),children:"Make default"}),e.jsx("button",{className:"text-red-600",onClick:()=>c.mutate(t.id),children:"Delete"})]})]},t.id))})]})}export{P as component};
