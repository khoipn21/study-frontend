import{c as E,j as e,b as u,L as q,U,f as M,r as n,I as L,B as h,X as B,S as V}from"./main-amE6mPDm.js";import{T as R,a as $,b as T}from"./tabs-kVy7bjmP.js";import{T as O,a as W}from"./thumbs-up-gXuOjcks.js";import{P as _,E as Q,T as H,f as w}from"./forum-1dxvdMGf.js";import{L as K}from"./lock-DIxZ9tmy.js";import{C as X,a as z}from"./circle-check-big-DaPFtRnM.js";import{M as D}from"./message-square-BFr9fZWG.js";import{D as G,a as J,b as Y,c as Z,d as ee,e as se,f as te}from"./dialog-BJ4RE-0q.js";import{L as k}from"./label-2d2k_XBO.js";import{T as ae}from"./textarea-DpBpWtX7.js";import{S as re,a as le,b as ne,c as ce,d as ie}from"./select-Nm150RRW.js";import{P}from"./plus-DxPzQ3h9.js";import{C as oe}from"./circle-alert-EGR15Bm1.js";import{L as de}from"./loader-circle-D5w-Lebd.js";import{F as me}from"./filter-CwOI3IPT.js";import{U as A}from"./users-q7MBazRm.js";import{C as xe}from"./clock-DsV4s8UB.js";import{T as ue}from"./trending-up-ZBWGlmuk.js";import"./index-BdQq_4o_.js";import"./index-B2I2svRw.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],ge=E("ArrowDownWideNarrow",he);function pe({post:t,variant:N="default",showCategory:m=!0,className:g}){const l=N==="compact";return e.jsx("div",{className:u("academic-card p-4 hover:shadow-md transition-shadow",l&&"p-3",g),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1 min-w-[40px]",children:[e.jsx("button",{className:"p-1 rounded hover:bg-muted transition-colors",children:e.jsx(O,{className:u("h-4 w-4",t.userVote==="up"?"text-primary fill-current":"text-muted-foreground")})}),e.jsx("span",{className:u("text-sm font-medium",t.votes>0?"text-success":t.votes<0?"text-destructive":"text-muted-foreground"),children:t.votes}),e.jsx("button",{className:"p-1 rounded hover:bg-muted transition-colors",children:e.jsx(W,{className:u("h-4 w-4",t.userVote==="down"?"text-destructive fill-current":"text-muted-foreground")})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.isPinned&&e.jsx(_,{className:"h-4 w-4 text-warning"}),t.isLocked&&e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),t.isSolved&&e.jsx(X,{className:"h-4 w-4 text-success"}),m&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:`var(--color-${t.category.color}-100)`,color:`var(--color-${t.category.color}-700)`},children:t.category.name})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),e.jsx("span",{children:t.views})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),e.jsx("span",{children:t.replies.length})]})]})]}),e.jsx(q,{to:"/forum/posts/$postId",params:{postId:t.id},className:"block group",children:e.jsx("h3",{className:u("font-semibold text-foreground group-hover:text-primary transition-colors line-clamp-2",l?"text-sm":"text-base"),children:t.title})}),!l&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:t.content}),t.tags.length>0&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 flex-wrap",children:[e.jsx(H,{className:"h-3 w-3 text-muted-foreground"}),t.tags.slice(0,3).map(o=>e.jsx("span",{className:"px-2 py-0.5 bg-muted text-muted-foreground rounded text-xs",children:o},o)),t.tags.length>3&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",t.tags.length-3]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.author.avatar?e.jsx("img",{src:t.author.avatar,alt:t.author.username,className:"h-5 w-5 rounded-full"}):e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:t.author.username}),e.jsx("span",{className:u("px-1.5 py-0.5 rounded text-xs font-medium",t.author.role==="instructor"&&"bg-primary/10 text-primary",t.author.role==="admin"&&"bg-destructive/10 text-destructive",t.author.role==="student"&&"bg-muted text-muted-foreground"),children:t.author.role})]})}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(z,{className:"h-3 w-3"}),e.jsx("span",{children:M(new Date(t.createdAt))})]})]})]})]})})}function F({children:t,courseId:N,categoryId:m,onSuccess:g}){const[l,o]=n.useState(!1),[j,v]=n.useState(!1),[p,x]=n.useState(""),[i,C]=n.useState([]),[r,c]=n.useState({title:"",content:"",categoryId:m||"",tags:[],newTag:""});n.useEffect(()=>{l&&f()},[l]);const f=async()=>{try{const s=await w.getCategories();C(s),!r.categoryId&&s.length>0&&c(a=>({...a,categoryId:s[0].id}))}catch(s){console.error("Failed to load categories:",s)}},d=()=>{const s=r.newTag.trim().toLowerCase();s&&!r.tags.includes(s)&&r.tags.length<5&&c(a=>({...a,tags:[...a.tags,s],newTag:""}))},y=s=>{c(a=>({...a,tags:a.tags.filter(b=>b!==s)}))},I=async s=>{if(s.preventDefault(),!r.title.trim()){x("Title is required");return}if(!r.content.trim()){x("Content is required");return}if(!r.categoryId){x("Category is required");return}v(!0),x("");try{const a={title:r.title.trim(),content:r.content.trim(),categoryId:r.categoryId,courseId:N,tags:r.tags},b=await w.createPost(a);o(!1),c({title:"",content:"",categoryId:m||"",tags:[],newTag:""}),g==null||g(b.id)}catch(a){console.error("Error creating post:",a),x(a instanceof Error?a.message:"Failed to create post. Please try again.")}finally{v(!1)}},S=()=>{o(!1),x(""),c({title:"",content:"",categoryId:m||"",tags:[],newTag:""})};return e.jsxs(G,{open:l,onOpenChange:o,children:[e.jsx(J,{asChild:!0,onClick:()=>o(!0),children:t}),e.jsxs(Y,{className:"sm:max-w-2xl",children:[e.jsxs(Z,{children:[e.jsxs(ee,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-primary"}),"Create New Post"]}),e.jsx(se,{children:"Start a new discussion or ask a question in the community forum"})]}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"title",children:"Title *"}),e.jsx(L,{id:"title",placeholder:"What's your question or topic?",value:r.title,onChange:s=>c(a=>({...a,title:s.target.value})),maxLength:200,required:!0}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[r.title.length,"/200"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Category *"}),e.jsxs(re,{value:r.categoryId,onValueChange:s=>c(a=>({...a,categoryId:s})),children:[e.jsx(le,{children:e.jsx(ne,{placeholder:"Select a category"})}),e.jsx(ce,{children:i.map(s=>e.jsx(ie,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`var(--color-${s.color}-500)`}}),e.jsx("span",{children:s.name})]})},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"content",children:"Content *"}),e.jsx(ae,{id:"content",placeholder:"Describe your question or topic in detail...",value:r.content,onChange:s=>c(a=>({...a,content:s.target.value})),rows:8,maxLength:5e3,required:!0}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[r.content.length,"/5000"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{children:"Tags (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{placeholder:"Add a tag...",value:r.newTag,onChange:s=>c(a=>({...a,newTag:s.target.value})),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),d())},maxLength:20}),e.jsx(h,{type:"button",variant:"outline",onClick:d,disabled:!r.newTag.trim()||r.tags.length>=5,children:"Add"})]}),r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary rounded-full text-sm",children:[s,e.jsx("button",{type:"button",onClick:()=>y(s),className:"hover:bg-primary/20 rounded-full p-0.5",children:e.jsx(B,{className:"h-3 w-3"})})]},s))}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Add up to 5 tags to help others find your post. Press Enter or click Add to add each tag."})]}),p&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-destructive/10 border border-destructive/20 rounded-lg text-sm text-destructive",children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx("span",{children:p})]}),e.jsxs(te,{className:"flex gap-3",children:[e.jsx(h,{type:"button",variant:"outline",onClick:S,disabled:j,children:"Cancel"}),e.jsxs(h,{type:"submit",disabled:j||!r.title.trim()||!r.content.trim(),children:[j?e.jsx(de,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(P,{className:"h-4 w-4 mr-2"}),j?"Creating...":"Create Post"]})]})]})]})]})}function Me(){const[t,N]=n.useState([]),[m,g]=n.useState([]),[l,o]=n.useState(null),[j,v]=n.useState(!0),[p,x]=n.useState(""),[i,C]=n.useState("all"),[r,c]=n.useState("recent"),[f,d]=n.useState(1);n.useEffect(()=>{y()},[i,r,p,f]);const y=async()=>{v(!0);try{const[s,a,b]=await Promise.all([w.getPosts({categoryId:i==="all"?void 0:i,search:p||void 0,sortBy:r,page:f,limit:20}),w.getCategories(),w.getForumStats()]);N(s.posts),g(a),o(b)}catch(s){console.error("Error loading forum data:",s)}finally{v(!1)}},I=s=>{s.preventDefault(),d(1),y()},S=s=>{y()};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b bg-card",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Community Forum"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect with fellow learners, ask questions, and share knowledge"})]}),e.jsx(F,{onSuccess:S,children:e.jsxs(h,{className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"New Post"]})})]}),l&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"academic-card p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:l.totalPosts}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Posts"})]}),e.jsxs("div",{className:"academic-card p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:l.totalReplies}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Replies"})]}),e.jsxs("div",{className:"academic-card p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:l.totalUsers}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Active Members"})]}),e.jsxs("div",{className:"academic-card p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary mb-1",children:m.reduce((s,a)=>s+a.postCount,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"All Discussions"})]})]})]})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"academic-card p-4",children:[e.jsxs("h3",{className:"font-semibold text-foreground mb-4 flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"Categories"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>{C("all"),d(1)},className:u("w-full text-left px-3 py-2 rounded-lg text-sm transition-colors",i==="all"?"bg-primary text-primary-foreground":"hover:bg-muted text-muted-foreground"),children:"All Categories"}),m.map(s=>e.jsxs("button",{onClick:()=>{C(s.id),d(1)},className:u("w-full text-left px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-between",i===s.id?"bg-primary text-primary-foreground":"hover:bg-muted text-muted-foreground"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`var(--color-${s.color}-500)`}}),e.jsx("span",{children:s.name})]}),e.jsx("span",{className:"text-xs",children:s.postCount})]},s.id))]})]}),(l==null?void 0:l.mostActiveUsers)&&l.mostActiveUsers.length>0&&e.jsxs("div",{className:"academic-card p-4",children:[e.jsxs("h3",{className:"font-semibold text-foreground mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Top Contributors"]}),e.jsx("div",{className:"space-y-3",children:l.mostActiveUsers.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-xs font-medium text-primary",children:a+1}),s.avatar?e.jsx("img",{src:s.avatar,alt:s.username,className:"w-6 h-6 rounded-full"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-muted flex items-center justify-center",children:e.jsx(A,{className:"h-3 w-3 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:s.username}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.reputation," rep"]})]})]},s.id))})]})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"academic-card p-4",children:[e.jsxs("form",{onSubmit:I,className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(L,{placeholder:"Search posts...",value:p,onChange:s=>x(s.target.value),className:"pl-10"})]}),e.jsx(h,{type:"submit",variant:"outline",children:"Search"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(R,{value:r,onValueChange:s=>{c(s),d(1)},children:e.jsxs($,{children:[e.jsxs(T,{value:"recent",className:"gap-2",children:[e.jsx(xe,{className:"h-3 w-3"}),"Recent"]}),e.jsxs(T,{value:"popular",className:"gap-2",children:[e.jsx(ue,{className:"h-3 w-3"}),"Popular"]}),e.jsxs(T,{value:"unanswered",className:"gap-2",children:[e.jsx(D,{className:"h-3 w-3"}),"Unanswered"]}),e.jsxs(T,{value:"solved",className:"gap-2",children:[e.jsx(D,{className:"h-3 w-3"}),"Solved"]})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.length," posts"]})]})]})]}),e.jsx("div",{className:"space-y-4",children:j?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,a)=>e.jsxs("div",{className:"academic-card p-4 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-muted rounded mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]},a))}):t.length>0?t.map(s=>e.jsx(pe,{post:s,showCategory:i==="all"},s.id)):e.jsxs("div",{className:"academic-card p-8 text-center",children:[e.jsx(D,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No posts found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:p?"Try adjusting your search terms or filters":"Be the first to start a discussion in this category!"}),e.jsx(F,{categoryId:i==="all"?void 0:i,onSuccess:S,children:e.jsxs(h,{children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Create First Post"]})})]})}),t.length>0&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>d(s=>Math.max(1,s-1)),disabled:f===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4 text-sm text-muted-foreground",children:["Page ",f]}),e.jsx(h,{variant:"outline",onClick:()=>d(s=>s+1),disabled:t.length<20,children:"Next"})]})]})]})})]})}export{Me as component};
